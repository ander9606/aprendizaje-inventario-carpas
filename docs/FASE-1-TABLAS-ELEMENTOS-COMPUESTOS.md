# ğŸ—„ï¸ FASE 1: DiseÃ±o de Tablas para Elementos Compuestos

## Sistema de Inventario - VENTO SAS

---

## ğŸ“Š DIAGRAMA DE RELACIONES

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                 â”‚
â”‚                        TABLAS EXISTENTES (no modificar)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  categorias  â”‚    â”‚  elementos   â”‚    â”‚   series     â”‚    â”‚    lotes     â”‚  â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚    â”‚              â”‚  â”‚
â”‚  â”‚ id           â”‚    â”‚ id           â”‚    â”‚ id           â”‚    â”‚ id           â”‚  â”‚
â”‚  â”‚ nombre       â”‚â—„â”€â”€â”€â”‚ categoria_id â”‚    â”‚ id_elemento  â”‚â”€â”€â”€â–ºâ”‚ elemento_id  â”‚  â”‚
â”‚  â”‚ padre_id     â”‚    â”‚ requiere_    â”‚    â”‚ numero_serie â”‚    â”‚ cantidad     â”‚  â”‚
â”‚  â”‚ emoji        â”‚    â”‚   series     â”‚    â”‚ estado       â”‚    â”‚ estado       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ material_id  â”‚    â”‚ ubicacion_id â”‚    â”‚ ubicacion_id â”‚  â”‚
â”‚                      â”‚ unidad_id    â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                              â”‚
â”‚  â”‚ ubicaciones  â”‚                               â”‚                              â”‚
â”‚  â”‚              â”‚                               â”‚ NUEVO CAMPO                  â”‚
â”‚  â”‚ id           â”‚                               â”‚ compuesto_id                 â”‚
â”‚  â”‚ nombre       â”‚                               â–¼                              â”‚
â”‚  â”‚ tipo         â”‚                                                              â”‚
â”‚  â”‚ es_principal â”‚                                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                              â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ SE CONECTAN CON
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                 â”‚
â”‚                           NUEVAS TABLAS A CREAR                                 â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        elementos_compuestos                              â”‚   â”‚
â”‚  â”‚  (Productos finales: Carpa 10x10 #001, Sala Lounge #001, etc.)          â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  nombre: "Carpa 10x10 Premium #001"                              â”‚      â”‚   â”‚
â”‚  â”‚  codigo: "CARPA-10X10-001"                                       â”‚      â”‚   â”‚
â”‚  â”‚  estado: disponible|alquilado|mantenimiento|incompleto           â”‚      â”‚   â”‚
â”‚  â”‚  precio_alquiler: 500000                                         â”‚      â”‚   â”‚
â”‚  â”‚  ubicacion_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ubicaciones                â”‚      â”‚   â”‚
â”‚  â”‚  categoria_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º categorias                 â”‚      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚          â”‚
â”‚                                                                     â”‚          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      compuesto_componentes                       â”‚      â”‚   â”‚
â”‚  â”‚  (QuÃ© componentes tiene cada producto)                           â”‚      â”‚   â”‚
â”‚  â”‚                                                                  â”‚      â”‚   â”‚
â”‚  â”‚  id                                                              â”‚      â”‚   â”‚
â”‚  â”‚  compuesto_id â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚  tipo_componente: 'serie' | 'lote'                                      â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  SI tipo='serie':                                                        â”‚   â”‚
â”‚  â”‚    serie_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º series (componente individual)     â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  SI tipo='lote':                                                         â”‚   â”‚
â”‚  â”‚    elemento_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º elementos                          â”‚   â”‚
â”‚  â”‚    cantidad: 8 (ej: 8 estacas)                                          â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  es_obligatorio: true|false                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       compuesto_alquileres                               â”‚   â”‚
â”‚  â”‚  (Historial de cada vez que se alquila un producto)                      â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  id                                                                      â”‚   â”‚
â”‚  â”‚  compuesto_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º elementos_compuestos               â”‚   â”‚
â”‚  â”‚  cliente_nombre: "Juan PÃ©rez"                                            â”‚   â”‚
â”‚  â”‚  cliente_telefono, cliente_email                                         â”‚   â”‚
â”‚  â”‚  evento_nombre: "Boda GarcÃ­a"                                            â”‚   â”‚
â”‚  â”‚  evento_direccion, evento_ciudad                                         â”‚   â”‚
â”‚  â”‚  fecha_inicio: 2024-12-20                                                â”‚   â”‚
â”‚  â”‚  fecha_fin_estimada: 2024-12-22                                          â”‚   â”‚
â”‚  â”‚  fecha_devolucion: NULL (se llena al devolver)                           â”‚   â”‚
â”‚  â”‚  estado: activo|devuelto|vencido|cancelado                               â”‚   â”‚
â”‚  â”‚  precio_acordado, deposito_cobrado                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    compuesto_devolucion_detalle                          â”‚   â”‚
â”‚  â”‚  (Estado de cada componente al momento de devoluciÃ³n)                    â”‚   â”‚
â”‚  â”‚                                                                          â”‚   â”‚
â”‚  â”‚  id                                                                      â”‚   â”‚
â”‚  â”‚  alquiler_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º compuesto_alquileres               â”‚   â”‚
â”‚  â”‚  componente_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º compuesto_componentes              â”‚   â”‚
â”‚  â”‚  estado_devuelto: 'bueno' | 'daÃ±ado' | 'perdido'                         â”‚   â”‚
â”‚  â”‚  notas: "Tela con rasgadura en esquina"                                  â”‚   â”‚
â”‚  â”‚  costo_reparacion: 50000                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ EXPLICACIÃ“N DE CADA TABLA

### 1ï¸âƒ£ TABLA: `elementos_compuestos`

**Â¿QuÃ© es?**
Esta es la tabla principal que almacena los **productos finales** listos para alquilar. Cada registro representa un producto armado completo.

**Ejemplo real:**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ nombre                  â”‚ codigo          â”‚ estado      â”‚ precio       â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ Carpa 10x10 Premium #001â”‚ CARPA-10X10-001 â”‚ disponible  â”‚ 500,000      â”‚
â”‚ 2  â”‚ Carpa 10x10 Premium #002â”‚ CARPA-10X10-002 â”‚ alquilado   â”‚ 500,000      â”‚
â”‚ 3  â”‚ Carpa 10x10 Premium #003â”‚ CARPA-10X10-003 â”‚ mantenimientoâ”‚ 500,000     â”‚
â”‚ 4  â”‚ Sala Lounge Elegance #001â”‚ SALA-ELEG-001  â”‚ disponible  â”‚ 350,000      â”‚
â”‚ 5  â”‚ Parasol Grande #001     â”‚ PARASOL-001     â”‚ disponible  â”‚ 150,000      â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Â¿CÃ³mo funciona en la app?**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PÃGINA: Productos de Alquiler                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [+ Crear Producto]        Filtrar: [Todos â–¼]                       â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ ğŸª Carpa 10x10 #001 â”‚  â”‚ ğŸª Carpa 10x10 #002 â”‚                  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
â”‚  â”‚ ğŸŸ¢ Disponible       â”‚  â”‚ ğŸ”µ Alquilado        â”‚                  â”‚
â”‚  â”‚ ğŸ“ Bodega Principal â”‚  â”‚ ğŸ“ Con cliente      â”‚                  â”‚
â”‚  â”‚ ğŸ’° $500,000         â”‚  â”‚ ğŸ’° $500,000         â”‚                  â”‚
â”‚  â”‚ ğŸ“¦ 7 componentes    â”‚  â”‚ ğŸ“¦ 7 componentes    â”‚                  â”‚
â”‚  â”‚                     â”‚  â”‚                     â”‚                  â”‚
â”‚  â”‚ [Alquilar] [Editar] â”‚  â”‚ [Devolver] [Ver]    â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Estados posibles:**

| Estado | Significado | Acciones permitidas |
|--------|-------------|---------------------|
| `disponible` | Listo para alquilar | Alquilar, Editar, Eliminar |
| `alquilado` | Actualmente con un cliente | Devolver, Ver detalles |
| `mantenimiento` | En reparaciÃ³n/limpieza | Ver detalles, Marcar como disponible |
| `incompleto` | Falta algÃºn componente obligatorio | Completar componentes |
| `retirado` | Ya no se usa | Ver historial |

---

### 2ï¸âƒ£ TABLA: `compuesto_componentes`

**Â¿QuÃ© es?**
Esta tabla define **quÃ© componentes** tiene cada producto compuesto. Es la relaciÃ³n entre el producto final y sus partes individuales.

**Ejemplo real - Carpa 10x10 #001:**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ compuesto_idâ”‚ tipo_componenteâ”‚ serie_id â”‚ elemento_id â”‚ cantidad â”‚ es_obligatorioâ”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 1           â”‚ serie          â”‚ 15       â”‚ NULL        â”‚ 1        â”‚ TRUE          â”‚ â† Tela TELA-007
â”‚ 2  â”‚ 1           â”‚ serie          â”‚ 23       â”‚ NULL        â”‚ 1        â”‚ TRUE          â”‚ â† MÃ¡stil MAST-015
â”‚ 3  â”‚ 1           â”‚ serie          â”‚ 24       â”‚ NULL        â”‚ 1        â”‚ TRUE          â”‚ â† MÃ¡stil MAST-016
â”‚ 4  â”‚ 1           â”‚ lote           â”‚ NULL     â”‚ 8           â”‚ 4        â”‚ TRUE          â”‚ â† 4 Postes
â”‚ 5  â”‚ 1           â”‚ lote           â”‚ NULL     â”‚ 12          â”‚ 8        â”‚ TRUE          â”‚ â† 8 Estacas
â”‚ 6  â”‚ 1           â”‚ lote           â”‚ NULL     â”‚ 15          â”‚ 12       â”‚ TRUE          â”‚ â† 12 Reatas
â”‚ 7  â”‚ 1           â”‚ serie          â”‚ 45       â”‚ NULL        â”‚ 1        â”‚ FALSE         â”‚ â† Luces LED-005 (opcional)
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Â¿CÃ³mo funciona en la app?**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MODAL: Detalle de Carpa 10x10 Premium #001                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  COMPONENTES OBLIGATORIOS:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ… Tela NÃ¡utica 10x10          Serie: TELA-007    ğŸŸ¢ Bueno  â”‚   â”‚
â”‚  â”‚ âœ… MÃ¡stil Central 3m           Serie: MAST-015    ğŸŸ¢ Bueno  â”‚   â”‚
â”‚  â”‚ âœ… MÃ¡stil Central 3m           Serie: MAST-016    ğŸŸ¢ Bueno  â”‚   â”‚
â”‚  â”‚ âœ… Postes MetÃ¡licos 2.5m       Cantidad: 4        ğŸŸ¢ Disp.  â”‚   â”‚
â”‚  â”‚ âœ… Estacas 30cm                Cantidad: 8        ğŸŸ¢ Disp.  â”‚   â”‚
â”‚  â”‚ âœ… Reatas Tensoras 5m          Cantidad: 12       ğŸŸ¢ Disp.  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  COMPONENTES OPCIONALES:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ… Set Luces LED               Serie: LED-005     ğŸŸ¢ Bueno  â”‚   â”‚
â”‚  â”‚ âŒ Cortinas Laterales          (no incluidas)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  [+ Agregar Componente]                            [Cerrar]         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tipos de componentes:**

| Tipo | DescripciÃ³n | Ejemplo |
|------|-------------|---------|
| `serie` | Componente individual con nÃºmero Ãºnico | Tela TELA-007, MÃ¡stil MAST-015 |
| `lote` | Componentes por cantidad (genÃ©ricos) | 8 estacas, 12 reatas |

**Diferencia clave:**
- **Serie**: Se selecciona CUÃL exactamente (TELA-007, no cualquier tela)
- **Lote**: Se especifica CUÃNTAS (8 estacas de las disponibles)

---

### 3ï¸âƒ£ TABLA: `compuesto_alquileres`

**Â¿QuÃ© es?**
Registra el **historial completo de alquileres** de cada producto. Cada vez que se alquila una carpa, se crea un registro aquÃ­.

**Ejemplo real:**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ compuesto_idâ”‚ cliente_nombre â”‚ evento_nombre    â”‚ fecha_ini  â”‚ fecha_fin  â”‚ estado   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 1           â”‚ Juan PÃ©rez     â”‚ Boda GarcÃ­a      â”‚ 2024-11-15 â”‚ 2024-11-17 â”‚ devuelto â”‚
â”‚ 2  â”‚ 1           â”‚ MarÃ­a LÃ³pez    â”‚ CumpleaÃ±os 15    â”‚ 2024-11-25 â”‚ 2024-11-26 â”‚ devuelto â”‚
â”‚ 3  â”‚ 2           â”‚ Carlos Ruiz    â”‚ Evento Corporativoâ”‚ 2024-12-20â”‚ 2024-12-22 â”‚ activo   â”‚
â”‚ 4  â”‚ 1           â”‚ Ana GÃ³mez      â”‚ Fiesta Navidad   â”‚ 2024-12-24 â”‚ 2024-12-26 â”‚ activo   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Â¿CÃ³mo funciona en la app?**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MODAL: Alquilar Carpa 10x10 Premium #001                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  INFORMACIÃ“N DEL CLIENTE                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Nombre*:     [Juan PÃ©rez________________________]           â”‚   â”‚
â”‚  â”‚ TelÃ©fono*:   [300-123-4567_____________________]           â”‚   â”‚
â”‚  â”‚ Email:       [juan.perez@email.com_____________]           â”‚   â”‚
â”‚  â”‚ Documento:   [1234567890_______________________]           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  INFORMACIÃ“N DEL EVENTO                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Nombre:      [Boda GarcÃ­a______________________]           â”‚   â”‚
â”‚  â”‚ DirecciÃ³n:   [Calle 123 #45-67, Finca Los Robles]          â”‚   â”‚
â”‚  â”‚ Ciudad:      [MedellÃ­n_________________________]           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  FECHAS                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Fecha inicio*:    [ğŸ“… 20/12/2024]                           â”‚   â”‚
â”‚  â”‚ Fecha fin*:       [ğŸ“… 22/12/2024]                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  INFORMACIÃ“N FINANCIERA                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Precio acordado:  [$500,000____]                            â”‚   â”‚
â”‚  â”‚ DepÃ³sito:         [$200,000____]                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚                              [Cancelar]  [âœ“ Confirmar Alquiler]     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Historial de un producto:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HISTORIAL: Carpa 10x10 Premium #001                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ğŸ“… 24 Dic 2024 - 26 Dic 2024                                       â”‚
â”‚  â”œâ”€â”€ Cliente: Ana GÃ³mez                                             â”‚
â”‚  â”œâ”€â”€ Evento: Fiesta Navidad                                         â”‚
â”‚  â”œâ”€â”€ Estado: ğŸ”µ ACTIVO                                              â”‚
â”‚  â””â”€â”€ Precio: $500,000                                               â”‚
â”‚                                                                     â”‚
â”‚  ğŸ“… 25 Nov 2024 - 26 Nov 2024                                       â”‚
â”‚  â”œâ”€â”€ Cliente: MarÃ­a LÃ³pez                                           â”‚
â”‚  â”œâ”€â”€ Evento: CumpleaÃ±os 15                                          â”‚
â”‚  â”œâ”€â”€ Estado: âœ… DEVUELTO                                            â”‚
â”‚  â””â”€â”€ Precio: $450,000                                               â”‚
â”‚                                                                     â”‚
â”‚  ğŸ“… 15 Nov 2024 - 17 Nov 2024                                       â”‚
â”‚  â”œâ”€â”€ Cliente: Juan PÃ©rez                                            â”‚
â”‚  â”œâ”€â”€ Evento: Boda GarcÃ­a                                            â”‚
â”‚  â”œâ”€â”€ Estado: âœ… DEVUELTO                                            â”‚
â”‚  â””â”€â”€ Precio: $500,000                                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4ï¸âƒ£ TABLA: `compuesto_devolucion_detalle`

**Â¿QuÃ© es?**
Registra el **estado de cada componente** al momento de la devoluciÃ³n. Permite saber si algo se daÃ±Ã³ o se perdiÃ³ durante el alquiler.

**Ejemplo real - DevoluciÃ³n del alquiler #1:**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ alquiler_id â”‚ componente_id â”‚ estado_devuelto â”‚ notas                       â”‚ costo_reparacionâ”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 1           â”‚ 1             â”‚ bueno           â”‚ NULL                        â”‚ NULL            â”‚
â”‚ 2  â”‚ 1           â”‚ 2             â”‚ bueno           â”‚ NULL                        â”‚ NULL            â”‚
â”‚ 3  â”‚ 1           â”‚ 3             â”‚ daÃ±ado          â”‚ Soldadura quebrada en base  â”‚ 80,000          â”‚
â”‚ 4  â”‚ 1           â”‚ 4             â”‚ bueno           â”‚ NULL                        â”‚ NULL            â”‚
â”‚ 5  â”‚ 1           â”‚ 5             â”‚ bueno           â”‚ 7 de 8 devueltas            â”‚ NULL            â”‚
â”‚ 6  â”‚ 1           â”‚ 5             â”‚ perdido         â”‚ 1 estaca perdida            â”‚ 15,000          â”‚
â”‚ 7  â”‚ 1           â”‚ 6             â”‚ bueno           â”‚ NULL                        â”‚ NULL            â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Â¿CÃ³mo funciona en la app?**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MODAL: Registrar DevoluciÃ³n - Carpa 10x10 #001                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Cliente: Juan PÃ©rez | Evento: Boda GarcÃ­a                          â”‚
â”‚  Alquilado: 15/11/2024 â†’ Hoy: 17/11/2024                           â”‚
â”‚                                                                     â”‚
â”‚  VERIFICACIÃ“N DE COMPONENTES:                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  Tela TELA-007:                                             â”‚   â”‚
â”‚  â”‚  Estado: (â—) Bueno  ( ) DaÃ±ado  ( ) Perdido                 â”‚   â”‚
â”‚  â”‚  Notas:  [________________________________]                 â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  MÃ¡stil MAST-015:                                           â”‚   â”‚
â”‚  â”‚  Estado: (â—) Bueno  ( ) DaÃ±ado  ( ) Perdido                 â”‚   â”‚
â”‚  â”‚  Notas:  [________________________________]                 â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  MÃ¡stil MAST-016:                                           â”‚   â”‚
â”‚  â”‚  Estado: ( ) Bueno  (â—) DaÃ±ado  ( ) Perdido                 â”‚   â”‚
â”‚  â”‚  Notas:  [Soldadura quebrada en la base____]                â”‚   â”‚
â”‚  â”‚  Costo reparaciÃ³n: [$80,000___]                             â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  Estacas (8 unidades):                                      â”‚   â”‚
â”‚  â”‚  Devueltas en buen estado: [_7_]                            â”‚   â”‚
â”‚  â”‚  DaÃ±adas:                  [_0_]                            â”‚   â”‚
â”‚  â”‚  Perdidas:                 [_1_]  â†’ Costo: $15,000          â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  ... (mÃ¡s componentes)                                      â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  RESUMEN:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Componentes OK:        5 de 7                              â”‚   â”‚
â”‚  â”‚  Componentes daÃ±ados:   1 (MÃ¡stil MAST-016)                 â”‚   â”‚
â”‚  â”‚  Componentes perdidos:  1 (1 estaca)                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚   â”‚
â”‚  â”‚  Costo total reparaciones: $95,000                          â”‚   â”‚
â”‚  â”‚  DepÃ³sito cobrado:         $200,000                         â”‚   â”‚
â”‚  â”‚  DepÃ³sito a devolver:      $105,000                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  Notas de devoluciÃ³n:                                               â”‚
â”‚  [El mÃ¡stil requiere soldadura, enviado a taller_________]          â”‚
â”‚                                                                     â”‚
â”‚                         [Cancelar]  [âœ“ Confirmar DevoluciÃ³n]        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5ï¸âƒ£ MODIFICACIÃ“N: Campo `compuesto_id` en tabla `series`

**Â¿QuÃ© es?**
Un nuevo campo en la tabla `series` existente que indica si una serie estÃ¡ asignada a un elemento compuesto.

**Antes:**
```
series
â”œâ”€â”€ id
â”œâ”€â”€ id_elemento
â”œâ”€â”€ numero_serie
â”œâ”€â”€ estado
â”œâ”€â”€ ubicacion
â””â”€â”€ ubicacion_id
```

**DespuÃ©s:**
```
series
â”œâ”€â”€ id
â”œâ”€â”€ id_elemento
â”œâ”€â”€ numero_serie
â”œâ”€â”€ estado
â”œâ”€â”€ ubicacion
â”œâ”€â”€ ubicacion_id
â””â”€â”€ compuesto_id  â† NUEVO (referencia a elementos_compuestos)
```

**Â¿Por quÃ© es necesario?**
Para **reservar** una serie especÃ­fica para un producto compuesto y evitar que se use en otro.

**Ejemplo:**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ id_elemento â”‚ numero_serie â”‚ estado      â”‚ compuesto_id â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 15 â”‚ 3           â”‚ TELA-007     â”‚ bueno       â”‚ 1            â”‚ â† Asignada a Carpa #001
â”‚ 16 â”‚ 3           â”‚ TELA-008     â”‚ bueno       â”‚ 2            â”‚ â† Asignada a Carpa #002
â”‚ 17 â”‚ 3           â”‚ TELA-009     â”‚ bueno       â”‚ NULL         â”‚ â† Disponible para asignar
â”‚ 23 â”‚ 5           â”‚ MAST-015     â”‚ bueno       â”‚ 1            â”‚ â† Asignada a Carpa #001
â”‚ 24 â”‚ 5           â”‚ MAST-016     â”‚ bueno       â”‚ 1            â”‚ â† Asignada a Carpa #001
â”‚ 25 â”‚ 5           â”‚ MAST-017     â”‚ bueno       â”‚ NULL         â”‚ â† Disponible para asignar
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLUJO COMPLETO DE DATOS

### Flujo: Crear un Producto Compuesto

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                â”‚
â”‚  PASO 1: Usuario crea el producto                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚                                                                                â”‚
â”‚  INSERT INTO elementos_compuestos                                              â”‚
â”‚  (nombre, codigo, precio_alquiler)                                             â”‚
â”‚  VALUES ('Carpa 10x10 Premium #001', 'CARPA-10X10-001', 500000)                â”‚
â”‚                                                                                â”‚
â”‚  â†’ Resultado: compuesto_id = 1                                                 â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  PASO 2: Usuario agrega componente CON SERIE (Tela)                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚
â”‚                                                                                â”‚
â”‚  a) Verificar que TELA-007 no estÃ¡ asignada a otro compuesto:                  â”‚
â”‚     SELECT compuesto_id FROM series WHERE id = 15                              â”‚
â”‚     â†’ Resultado: NULL (disponible)                                             â”‚
â”‚                                                                                â”‚
â”‚  b) Asignar la serie al compuesto:                                             â”‚
â”‚     UPDATE series SET compuesto_id = 1 WHERE id = 15                           â”‚
â”‚                                                                                â”‚
â”‚  c) Crear la relaciÃ³n:                                                         â”‚
â”‚     INSERT INTO compuesto_componentes                                          â”‚
â”‚     (compuesto_id, tipo_componente, serie_id, es_obligatorio)                  â”‚
â”‚     VALUES (1, 'serie', 15, TRUE)                                              â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  PASO 3: Usuario agrega componente POR LOTE (Estacas)                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
â”‚                                                                                â”‚
â”‚  a) Verificar stock disponible de estacas:                                     â”‚
â”‚     SELECT SUM(cantidad) FROM lotes                                            â”‚
â”‚     WHERE elemento_id = 12 AND estado IN ('nuevo', 'bueno')                    â”‚
â”‚     â†’ Resultado: 200 (suficientes para 8)                                      â”‚
â”‚                                                                                â”‚
â”‚  b) Crear la relaciÃ³n (NO mueve stock aÃºn):                                    â”‚
â”‚     INSERT INTO compuesto_componentes                                          â”‚
â”‚     (compuesto_id, tipo_componente, elemento_id, cantidad, es_obligatorio)     â”‚
â”‚     VALUES (1, 'lote', 12, 8, TRUE)                                            â”‚
â”‚                                                                                â”‚
â”‚  NOTA: El stock NO se reserva hasta el momento del alquiler                    â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  RESULTADO FINAL:                                                              â”‚
â”‚                                                                                â”‚
â”‚  elementos_compuestos:                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ 1  â”‚ Carpa 10x10 Premium #001â”‚ disponible  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                                â”‚
â”‚  compuesto_componentes:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ 1  â”‚ 1           â”‚ serie  â”‚ 15       â”‚ NULL     â”‚ 1        â”‚ Tela         â”‚
â”‚  â”‚ 2  â”‚ 1           â”‚ serie  â”‚ 23       â”‚ NULL     â”‚ 1        â”‚ MÃ¡stil 1     â”‚
â”‚  â”‚ 3  â”‚ 1           â”‚ serie  â”‚ 24       â”‚ NULL     â”‚ 1        â”‚ MÃ¡stil 2     â”‚
â”‚  â”‚ 4  â”‚ 1           â”‚ lote   â”‚ NULL     â”‚ 8        â”‚ 4        â”‚ Postes       â”‚
â”‚  â”‚ 5  â”‚ 1           â”‚ lote   â”‚ NULL     â”‚ 12       â”‚ 8        â”‚ Estacas      â”‚
â”‚  â”‚ 6  â”‚ 1           â”‚ lote   â”‚ NULL     â”‚ 15       â”‚ 12       â”‚ Reatas       â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                                â”‚
â”‚  series (actualizadas):                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚ 15 â”‚ TELA-007     â”‚ compuesto=1  â”‚ â† Reservada                             â”‚
â”‚  â”‚ 23 â”‚ MAST-015     â”‚ compuesto=1  â”‚ â† Reservada                             â”‚
â”‚  â”‚ 24 â”‚ MAST-016     â”‚ compuesto=1  â”‚ â† Reservada                             â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flujo: Alquilar un Producto

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                â”‚
â”‚  PASO 1: VALIDAR DISPONIBILIDAD (CRÃTICO)                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚
â”‚                                                                                â”‚
â”‚  Para cada componente tipo 'serie':                                            â”‚
â”‚    â†’ Verificar que estado = 'nuevo' o 'bueno'                                  â”‚
â”‚    â†’ Si estado = 'alquilado' o 'mantenimiento' â†’ BLOQUEAR                      â”‚
â”‚                                                                                â”‚
â”‚  Para cada componente tipo 'lote':                                             â”‚
â”‚    â†’ Verificar que hay suficiente stock disponible                             â”‚
â”‚    â†’ Si stock < cantidad_requerida â†’ BLOQUEAR                                  â”‚
â”‚                                                                                â”‚
â”‚  Si hay problemas â†’ Mostrar mensaje y NO continuar                             â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  PASO 2: REGISTRAR EL ALQUILER                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚                                                                                â”‚
â”‚  INSERT INTO compuesto_alquileres                                              â”‚
â”‚  (compuesto_id, cliente_nombre, fecha_inicio, fecha_fin_estimada, ...)         â”‚
â”‚  VALUES (1, 'Juan PÃ©rez', '2024-12-20', '2024-12-22', ...)                      â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  PASO 3: ACTUALIZAR ESTADO DEL COMPUESTO                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚                                                                                â”‚
â”‚  UPDATE elementos_compuestos                                                   â”‚
â”‚  SET estado = 'alquilado', ubicacion_id = NULL                                 â”‚
â”‚  WHERE id = 1                                                                  â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  PASO 4: ACTUALIZAR SERIES (automÃ¡tico)                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚                                                                                â”‚
â”‚  UPDATE series                                                                 â”‚
â”‚  SET estado = 'alquilado', ubicacion = NULL, ubicacion_id = NULL               â”‚
â”‚  WHERE compuesto_id = 1                                                        â”‚
â”‚                                                                                â”‚
â”‚  â†’ TELA-007: bueno â†’ alquilado                                                 â”‚
â”‚  â†’ MAST-015: bueno â†’ alquilado                                                 â”‚
â”‚  â†’ MAST-016: bueno â†’ alquilado                                                 â”‚
â”‚                                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚  PASO 5: MOVER CANTIDADES DE LOTES (automÃ¡tico)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚
â”‚                                                                                â”‚
â”‚  Para cada componente tipo 'lote':                                             â”‚
â”‚                                                                                â”‚
â”‚  Ejemplo con estacas (elemento_id=12, cantidad=8):                             â”‚
â”‚                                                                                â”‚
â”‚  ANTES:                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Lote 1: 200 estacas (bueno, Bodega A)      â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                                â”‚
â”‚  OPERACIÃ“N:                                                                    â”‚
â”‚  â†’ Restar 8 del lote disponible                                                â”‚
â”‚  â†’ Crear/sumar 8 al lote "alquilado"                                           â”‚
â”‚                                                                                â”‚
â”‚  DESPUÃ‰S:                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚ Lote 1: 192 estacas (bueno, Bodega A)      â”‚                               â”‚
â”‚  â”‚ Lote 2: 8 estacas (alquilado, NULL)        â”‚ â† Nuevo/actualizado           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ SCRIPT SQL FINAL

```sql
-- ============================================================
-- SCRIPT: Crear tablas para Sistema de Elementos Compuestos
-- Base de datos: inventario_carpas
-- Fecha: Diciembre 2024
-- ============================================================

-- Verificar que estamos en la base de datos correcta
USE inventario_carpas;

-- ============================================================
-- 1. TABLA PRINCIPAL: elementos_compuestos
-- ============================================================
CREATE TABLE IF NOT EXISTS elementos_compuestos (
    id INT PRIMARY KEY AUTO_INCREMENT,

    -- IdentificaciÃ³n
    nombre VARCHAR(200) NOT NULL COMMENT 'Ej: Carpa 10x10 Premium #001',
    codigo VARCHAR(50) UNIQUE COMMENT 'Ej: CARPA-10X10-001',
    descripcion TEXT,

    -- Estado del producto
    estado ENUM('disponible', 'alquilado', 'mantenimiento', 'incompleto', 'retirado')
           DEFAULT 'disponible' NOT NULL,

    -- UbicaciÃ³n actual (NULL cuando estÃ¡ alquilado)
    ubicacion_id INT,

    -- InformaciÃ³n comercial
    precio_alquiler DECIMAL(12,2) COMMENT 'Precio base de alquiler',
    deposito DECIMAL(12,2) COMMENT 'DepÃ³sito requerido',

    -- CategorizaciÃ³n opcional
    categoria_id INT COMMENT 'Para organizar por tipo (Carpas, Salas, etc.)',

    -- Extras
    imagen_url VARCHAR(500),
    notas TEXT,

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Keys
    CONSTRAINT fk_compuesto_ubicacion
        FOREIGN KEY (ubicacion_id) REFERENCES ubicaciones(id) ON DELETE SET NULL,
    CONSTRAINT fk_compuesto_categoria
        FOREIGN KEY (categoria_id) REFERENCES categorias(id) ON DELETE SET NULL,

    -- Ãndices
    INDEX idx_compuesto_estado (estado),
    INDEX idx_compuesto_ubicacion (ubicacion_id),
    INDEX idx_compuesto_categoria (categoria_id)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Productos finales compuestos listos para alquilar (carpas armadas, salas lounge, etc.)';


-- ============================================================
-- 2. TABLA DE RELACIÃ“N: compuesto_componentes
-- ============================================================
CREATE TABLE IF NOT EXISTS compuesto_componentes (
    id INT PRIMARY KEY AUTO_INCREMENT,

    -- Referencia al producto padre
    compuesto_id INT NOT NULL,

    -- Tipo de componente
    tipo_componente ENUM('serie', 'lote') NOT NULL
        COMMENT 'serie=componente individual, lote=componente por cantidad',

    -- Para tipo='serie': referencia a una serie especÃ­fica
    serie_id INT COMMENT 'ID de la serie especÃ­fica (ej: TELA-007)',

    -- Para tipo='lote': referencia al elemento + cantidad
    elemento_id INT COMMENT 'ID del elemento (ej: Estacas)',
    cantidad INT DEFAULT 1 COMMENT 'Cantidad requerida (ej: 8 estacas)',

    -- ConfiguraciÃ³n
    es_obligatorio BOOLEAN DEFAULT TRUE
        COMMENT 'TRUE=obligatorio para que funcione, FALSE=opcional/mejora',

    -- Notas
    notas VARCHAR(255),

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- Foreign Keys
    CONSTRAINT fk_componente_compuesto
        FOREIGN KEY (compuesto_id) REFERENCES elementos_compuestos(id) ON DELETE CASCADE,
    CONSTRAINT fk_componente_serie
        FOREIGN KEY (serie_id) REFERENCES series(id) ON DELETE SET NULL,
    CONSTRAINT fk_componente_elemento
        FOREIGN KEY (elemento_id) REFERENCES elementos(id) ON DELETE SET NULL,

    -- Ãndices
    INDEX idx_componente_compuesto (compuesto_id),
    INDEX idx_componente_serie (serie_id),
    INDEX idx_componente_elemento (elemento_id),
    INDEX idx_componente_tipo (tipo_componente)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='RelaciÃ³n entre productos compuestos y sus componentes individuales';


-- ============================================================
-- 3. MODIFICAR TABLA SERIES: Agregar referencia a compuesto
-- ============================================================
-- Verificar si la columna ya existe antes de agregarla
SET @column_exists = (
    SELECT COUNT(*)
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_SCHEMA = DATABASE()
    AND TABLE_NAME = 'series'
    AND COLUMN_NAME = 'compuesto_id'
);

SET @sql = IF(@column_exists = 0,
    'ALTER TABLE series
     ADD COLUMN compuesto_id INT DEFAULT NULL
     COMMENT "ID del elemento compuesto al que pertenece esta serie (NULL=disponible para asignar)",
     ADD CONSTRAINT fk_serie_compuesto
         FOREIGN KEY (compuesto_id) REFERENCES elementos_compuestos(id) ON DELETE SET NULL,
     ADD INDEX idx_serie_compuesto (compuesto_id)',
    'SELECT "La columna compuesto_id ya existe en series"'
);

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;


-- ============================================================
-- 4. TABLA DE ALQUILERES: compuesto_alquileres
-- ============================================================
CREATE TABLE IF NOT EXISTS compuesto_alquileres (
    id INT PRIMARY KEY AUTO_INCREMENT,

    -- Referencia al producto alquilado
    compuesto_id INT NOT NULL,

    -- InformaciÃ³n del cliente
    cliente_nombre VARCHAR(200) NOT NULL,
    cliente_telefono VARCHAR(20),
    cliente_email VARCHAR(100),
    cliente_documento VARCHAR(50) COMMENT 'CÃ©dula, NIT, etc.',

    -- InformaciÃ³n del evento
    evento_nombre VARCHAR(200),
    evento_direccion TEXT,
    evento_ciudad VARCHAR(100),

    -- Fechas del alquiler
    fecha_inicio DATE NOT NULL,
    fecha_fin_estimada DATE NOT NULL,
    fecha_devolucion DATE COMMENT 'Se llena cuando se devuelve',

    -- Estado del alquiler
    estado ENUM('activo', 'devuelto', 'vencido', 'cancelado') DEFAULT 'activo',

    -- InformaciÃ³n financiera
    precio_acordado DECIMAL(12,2),
    deposito_cobrado DECIMAL(12,2),
    deposito_devuelto DECIMAL(12,2) COMMENT 'DepÃ³sito devuelto al cliente',

    -- Notas
    notas_alquiler TEXT COMMENT 'Notas al momento de alquilar',
    notas_devolucion TEXT COMMENT 'Notas al momento de devolver',

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- Foreign Keys
    CONSTRAINT fk_alquiler_compuesto
        FOREIGN KEY (compuesto_id) REFERENCES elementos_compuestos(id) ON DELETE CASCADE,

    -- Ãndices
    INDEX idx_alquiler_compuesto (compuesto_id),
    INDEX idx_alquiler_estado (estado),
    INDEX idx_alquiler_fechas (fecha_inicio, fecha_fin_estimada),
    INDEX idx_alquiler_cliente (cliente_nombre(50))

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Historial de alquileres de productos compuestos';


-- ============================================================
-- 5. TABLA DE DETALLE DE DEVOLUCIÃ“N: compuesto_devolucion_detalle
-- ============================================================
CREATE TABLE IF NOT EXISTS compuesto_devolucion_detalle (
    id INT PRIMARY KEY AUTO_INCREMENT,

    -- Referencias
    alquiler_id INT NOT NULL,
    componente_id INT NOT NULL,

    -- Estado reportado en la devoluciÃ³n
    estado_devuelto ENUM('bueno', 'daÃ±ado', 'perdido') NOT NULL,

    -- Detalles
    notas TEXT COMMENT 'DescripciÃ³n del daÃ±o o problema',
    costo_reparacion DECIMAL(12,2) COMMENT 'Costo estimado de reparaciÃ³n',

    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- Foreign Keys
    CONSTRAINT fk_devolucion_alquiler
        FOREIGN KEY (alquiler_id) REFERENCES compuesto_alquileres(id) ON DELETE CASCADE,
    CONSTRAINT fk_devolucion_componente
        FOREIGN KEY (componente_id) REFERENCES compuesto_componentes(id) ON DELETE CASCADE,

    -- Ãndices
    INDEX idx_devolucion_alquiler (alquiler_id),
    INDEX idx_devolucion_estado (estado_devuelto)

) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci
COMMENT='Detalle del estado de cada componente al momento de devoluciÃ³n';


-- ============================================================
-- 6. DATOS DE EJEMPLO (opcional - para pruebas)
-- ============================================================

-- Insertar algunos productos de ejemplo
INSERT INTO elementos_compuestos (nombre, codigo, descripcion, estado, precio_alquiler, deposito) VALUES
('Carpa 10x10 Premium #001', 'CARPA-10X10-001', 'Carpa blanca premium con tela nÃ¡utica resistente al agua. Incluye mÃ¡stiles, postes y accesorios.', 'disponible', 500000.00, 200000.00),
('Carpa 10x10 Premium #002', 'CARPA-10X10-002', 'Carpa blanca premium con tela nÃ¡utica resistente al agua. Incluye mÃ¡stiles, postes y accesorios.', 'disponible', 500000.00, 200000.00),
('Sala Lounge Elegance #001', 'SALA-ELEG-001', 'Sala lounge completa con sofÃ¡s blancos, mesa de centro y cojines decorativos.', 'disponible', 350000.00, 150000.00);

-- Mensaje de confirmaciÃ³n
SELECT 'âœ… Tablas creadas exitosamente' AS mensaje;
SELECT 'Tablas creadas:' AS info;
SELECT '  - elementos_compuestos' AS tabla_1;
SELECT '  - compuesto_componentes' AS tabla_2;
SELECT '  - compuesto_alquileres' AS tabla_3;
SELECT '  - compuesto_devolucion_detalle' AS tabla_4;
SELECT '  - Columna compuesto_id agregada a series' AS modificacion;
```

---

## âœ… CHECKLIST DE VERIFICACIÃ“N

DespuÃ©s de ejecutar el script, verifica:

```sql
-- Ver que las tablas existen
SHOW TABLES LIKE '%compuesto%';

-- Ver estructura de cada tabla
DESCRIBE elementos_compuestos;
DESCRIBE compuesto_componentes;
DESCRIBE compuesto_alquileres;
DESCRIBE compuesto_devolucion_detalle;

-- Verificar campo agregado a series
SHOW COLUMNS FROM series LIKE 'compuesto_id';

-- Ver datos de ejemplo
SELECT * FROM elementos_compuestos;

-- Ver foreign keys
SELECT
    TABLE_NAME,
    COLUMN_NAME,
    CONSTRAINT_NAME,
    REFERENCED_TABLE_NAME,
    REFERENCED_COLUMN_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE TABLE_SCHEMA = DATABASE()
AND REFERENCED_TABLE_NAME IS NOT NULL
AND TABLE_NAME LIKE '%compuesto%';
```

---

## ğŸ“Š RESUMEN DE TABLAS

| Tabla | PropÃ³sito | Registros esperados |
|-------|-----------|---------------------|
| `elementos_compuestos` | Productos finales | ~10-50 (cada carpa/sala) |
| `compuesto_componentes` | Componentes por producto | ~5-10 por producto |
| `compuesto_alquileres` | Historial de alquileres | Crece con cada alquiler |
| `compuesto_devolucion_detalle` | VerificaciÃ³n de devoluciones | ~5-10 por devoluciÃ³n |

---

**Â¿Deseas que ejecute este script SQL o prefieres revisarlo primero?**
